<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.winway.scm.persistence.dao.ScmXsBigContractProductSumDao">
	<resultMap id="ScmXsBigContractProductSum" type="com.winway.scm.model.ScmXsBigContractProductSum">
		<id property="id" column="id" jdbcType="VARCHAR"/>
		<result property="ownerId" column="ownerId" jdbcType="VARCHAR"/>
		<result property="commerceFirstId" column="commerceFirstId" jdbcType="VARCHAR"/>
		<result property="productGauge" column="productGauge" jdbcType="VARCHAR"/>
		<result property="MedicineType" column="MedicineType" jdbcType="VARCHAR"/>
		<result property="commonName" column="commonName" jdbcType="VARCHAR"/>
		<result property="unit" column="unit" jdbcType="VARCHAR"/>
		<result property="aChange" column="aChange" jdbcType="NUMERIC"/>
		<result property="suppyType" column="suppyType" jdbcType="VARCHAR"/>
		<result property="suggestApplyNum" column="suggestApplyNum" jdbcType="NUMERIC"/>
		<result property="lastShipmentDate" column="lastShipmentDate" jdbcType="TIMESTAMP"/>
		<result property="SMSCurrentMonthSales" column="SMSCurrentMonthSales" jdbcType="NUMERIC"/>
		<result property="productCode" column="productCode" jdbcType="VARCHAR"/>
		<result property="isSMS" column="isSMS" jdbcType="VARCHAR"/>
		<result property="theNumber" column="theNumber" jdbcType="NUMERIC"/>
		<result property="packageNum" column="packageNum" jdbcType="NUMERIC"/>
		<result property="unitPrice" column="unitPrice" jdbcType="NUMERIC"/>
		<result property="sumPrice" column="sumPrice" jdbcType="NUMERIC"/>
		<result property="surplusSUm" column="surplusSUm" jdbcType="NUMERIC"/>
		<result property="agreementSummaryId" column="agreementSummaryId" jdbcType="VARCHAR"/>

		<result property="v_productName" column="productName" jdbcType="VARCHAR"/>
		<result property="MedicineType" column="MedicineType" jdbcType="VARCHAR"/>
		<result property="v_productState" column="productState" jdbcType="VARCHAR"/>
		<result property="BigContractProductId" column="BigContractProductId" jdbcType="VARCHAR"/>

		
	</resultMap>
	
	<insert id="create" parameterType="com.winway.scm.model.ScmXsBigContractProductSum">
		INSERT INTO scm_xs_bigcontractproductsum
		(id,ownerId,commerceFirstId,productGauge,MedicineType,commonName,unit,aChange,suppyType,suggestApplyNum,lastShipmentDate,SMSCurrentMonthSales,productCode,isSMS,theNumber,packageNum,unitPrice,sumPrice,surplusSUm,agreementSummaryId)
		VALUES 
		(#{id,jdbcType=VARCHAR}, #{ownerId,jdbcType=VARCHAR}, #{commerceFirstId,jdbcType=VARCHAR}, #{productGauge,jdbcType=VARCHAR}, #{MedicineType,jdbcType=VARCHAR}, #{commonName,jdbcType=VARCHAR}, #{unit,jdbcType=VARCHAR}, #{aChange,jdbcType=NUMERIC}, 
		#{suppyType,jdbcType=VARCHAR}, #{suggestApplyNum,jdbcType=NUMERIC}, #{lastShipmentDate,jdbcType=TIMESTAMP}, 
		#{SMSCurrentMonthSales,jdbcType=NUMERIC}, #{productCode,jdbcType=VARCHAR}, #{isSMS,jdbcType=VARCHAR}, #{theNumber,jdbcType=NUMERIC}, 
		#{packageNum,jdbcType=NUMERIC}, #{unitPrice,jdbcType=NUMERIC}, #{sumPrice,jdbcType=NUMERIC}, 
		#{surplusSUm,jdbcType=NUMERIC},#{agreementSummaryId,jdbcType=VARCHAR})
	</insert>
	
	<select id="get"   parameterType="java.lang.String" resultMap="ScmXsBigContractProductSum">
		SELECT * FROM scm_xs_bigcontractproductsum 
		WHERE 
		id=#{id}
	</select>
	
	<select id="listConProductSumBySummaryID"   parameterType="java.lang.String" resultMap="ScmXsBigContractProductSum">
		SELECT * FROM v_conProductSumBySummaryID
		<where>
			<if test="whereSql!=null">
				${whereSql}
			</if>
		</where>
		<if test="orderBySql!=null">
			ORDER BY ${orderBySql}
		</if>
		<if test="orderBySql==null">
			ORDER BY id DESC
		</if>
	</select>
	<select id="listConProductSumByUpdate"   parameterType="java.lang.String" resultMap="ScmXsBigContractProductSum">
		SELECT
		  a.id                    AS BigContractProductId,
		  b.productName           AS productName,
		  b.MedicineType          AS MedicineType,
		  b.commonName            AS commonName,
		  b.productState          AS productState,
		  b.unit                  AS unit,
		  a.suppyType             AS suppyType,
		  a.agreementSummaryId    AS agreementSummaryId,
		  '0'                     AS suggestApplyNum,
		  a.lastShipmentDate      AS lastShipmentDate,
		  '0'                     AS SMSCurrentMonthSales,
		  c.isSMS                 AS isSMS,
		  a.unitPrice             AS unitPrice,
		  a.ownerId               AS ownerId,
		  a.surplusSUm            AS surplusSUm,
		  a.productCode           AS productCode,
		  c.id                    AS id,
		  IFNULL(c.theNumber,0)   AS theNumber,
		  IFNULL(c.packageNum,0)  AS packageNum,
		  IFNULL(c.sumPrice,0)    AS sumPrice,
		  c.aChange               AS aChange,
		  c.BigContractAllotId    AS bigContractAllotId
		FROM scm_xs_bigcontractproductsum a 
		JOIN scm_zsj_product b ON a.productCode = b.productCode
		LEFT JOIN scm_xs_bigcontractallotproduct c ON a.id = c.BigContractProductId AND 
		(c.bigContractAllotId = #{arg0} OR c.bigContractAllotId IS NULL)
		where agreementSummaryId = #{arg1}
	</select>
	
	<select id="getByProductCode"   parameterType="java.lang.String" resultMap="ScmXsBigContractProductSum">
		SELECT * FROM scm_xs_bigcontractproductsum 
		WHERE 
		id = #{arg2}
	</select>
	
	<select id="getByOwnerIdAndcommerId"   parameterType="java.lang.String" resultMap="ScmXsBigContractProductSum">
		SELECT * FROM scm_xs_bigcontractproductsum 
		WHERE 
		ownerId=#{arg0} and commerceFirstId=#{arg1} and agreementSummaryId = #{arg2}
	</select>
	
	<select id="query" parameterType="java.util.Map" resultMap="ScmXsBigContractProductSum">
		SELECT * FROM scm_xs_bigcontractproductsum
		<where>
			<if test="whereSql!=null">
				${whereSql}
			</if>
		</where>
		<if test="orderBySql!=null">
			ORDER BY ${orderBySql}
		</if>
		<if test="orderBySql==null">
			ORDER BY id DESC
		</if>
	</select>
	
	<update id="update" parameterType="com.winway.scm.model.ScmXsBigContractProductSum">
		UPDATE scm_xs_bigcontractproductsum SET
		ownerId=#{ownerId,jdbcType=VARCHAR},
		commerceFirstId=#{commerceFirstId,jdbcType=VARCHAR},
		productGauge=#{productGauge,jdbcType=VARCHAR},
		MedicineType=#{MedicineType,jdbcType=VARCHAR},
		commonName=#{commonName,jdbcType=VARCHAR},
		unit=#{unit,jdbcType=VARCHAR},
		aChange=#{aChange,jdbcType=NUMERIC},
		suppyType=#{suppyType,jdbcType=VARCHAR},
		suggestApplyNum=#{suggestApplyNum,jdbcType=NUMERIC},
		lastShipmentDate=#{lastShipmentDate,jdbcType=TIMESTAMP},
		SMSCurrentMonthSales=#{SMSCurrentMonthSales,jdbcType=NUMERIC},
		productCode=#{productCode,jdbcType=VARCHAR},
		isSMS=#{isSMS,jdbcType=VARCHAR},
		theNumber=#{theNumber,jdbcType=NUMERIC},
		packageNum=#{packageNum,jdbcType=NUMERIC},
		unitPrice=#{unitPrice,jdbcType=NUMERIC},
		sumPrice=#{sumPrice,jdbcType=NUMERIC},
		surplusSUm=#{surplusSUm,jdbcType=NUMERIC},
		agreementSummaryId=#{agreementSummaryId,jdbcType=VARCHAR}
		WHERE
		id=#{id}
	</update>
	
	<delete id="remove" parameterType="java.lang.String">
		DELETE FROM scm_xs_bigcontractproductsum 
		WHERE
		id=#{id}
	</delete>
	
	<select id="listByFhFocusShipmentsSet"  resultMap="ScmXsBigContractProductSum">
		SELECT * FROM scm_xs_bigcontractproductsum 
		WHERE productCode in ( '0'
		<foreach collection="arg3" item="product" open="," index="index" separator=",">
		  #{product.productCode}
		</foreach>
		) and ownerId=#{arg1} and commerceFirstId=#{arg0} and agreementSummaryId = #{arg2} 
	</select>
	
</mapper>